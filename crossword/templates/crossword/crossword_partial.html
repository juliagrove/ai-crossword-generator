{% load static %}
<div class="crossword-container">
    {% if error_message %}
        <div class="alert">
            Failed to Generate Crossword
            <div class= "dev-error-message">
                Dev: {{ error_message }}
            </div>
        </div>
    {% else %}
        <!-- List of Clues -->
        <div class="wordList">
            <div class="across-clues">
                <h3>ACROSS</h3>
                <ul>
                    {% for clue in across_clues %}
                        <li><strong>{{ clue.number }}.</strong> {{ clue.clue }}</li>
                    {% endfor %}
                </ul>
            </div>
            <div class="down-clues">
                <h3>DOWN</h3>
                <ul>
                    {% for clue in down_clues %}
                        <li><strong>{{ clue.number }}.</strong> {{ clue.clue }}</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
        <!-- Crossword Grid -->
        <div class="grid">
            <table class="crossword-table">
            {% for row in crossword_grid %}
                <tr>
                {% for cell in row %}
                    <td class="{% if cell == '-' %}black-square{% else %}white-square{% endif %}">
                    {% if cell != '-' %}
                        <div class="cell">
                        {% if cell|length > 1 %}
                            <span class="corner-number">{{ cell|slice:':-1' }}</span>
                        {% endif %}
                        <input
                            type="text"
                            maxlength="1"
                            class="crossword-input"
                            data-answer="{{ cell|slice:'-1:' }}" 
                        />
                        </div>
                    {% endif %}
                    </td>
                {% endfor %}
                </tr>
            {% endfor %}
            </table>
        </div>
        <!-- Toggle for showing correct/incorrect cells  -->
        <label class="toggle-container">
            <label class="switch">
                <input type="checkbox"
                id="errorToggle"
                {% if not from_saved %}checked{% endif %}>         
            <span class="slider">AUTO CHECK</span>
            </label>
        </label>

        {{ crossword_grid|json_script:"solution-grid-data" }}
        {{ across_clues|json_script:"across-clues-data" }}
        {{ down_clues|json_script:"down-clues-data" }}
        {{ category|json_script:"category-data" }}
        {{ progress_grid|default:"[]"|json_script:"progress-grid-data" }}

        {% if user.is_authenticated %}
            <button 
                id="save-crossword-btn" 
                type="button"
                data-save-url="{% url 'crossword:save_crossword' %}"
            >
                SAVE CROSSWORD
            </button>
        {% else %}
            <p><a href="{% url 'login' %}">Log in</a> to save your crossword.</p>
        {% endif %}
    {% endif %}  
</div>