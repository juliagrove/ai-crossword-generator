{% load static %}
<div class="crossword-container">
    {% if error_message %}
        <div class="alert">
            Failed to Generate Crossword
            <div class= "dev-error-message">
                Dev: {{ error_message }}
            </div>
        </div>
    {% else %}
        <div class="left-side">

            <!-- Reveal solution button -->
            <div class="reveal-container">
                <button 
                    id="reveal-solution-btn" 
                    class="save-btn" 
                    type="button"
                >
                    REVEAL SOLUTION
                </button>
            </div>

            <!-- List of Clues -->
            <div class="wordList">
                <div class="across-clues">
                    <h3>ACROSS</h3>
                    <ul>
                        {% for clue in across_clues %}
                            <li
                                class="clue-item"
                                data-direction="across"
                                data-clue-number="{{ clue.number }}"
                            >
                                <strong>{{ clue.number }}.</strong> {{ clue.clue }}
                            </li>
                        {% endfor %}
                    </ul>
                </div>
                <div class="down-clues">
                    <h3>DOWN</h3>
                    <ul>
                        {% for clue in down_clues %}
                            <li
                                class="clue-item"
                                data-direction="down"
                                data-clue-number="{{ clue.number }}"
                            >
                                <strong>{{ clue.number }}.</strong> {{ clue.clue }}</li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
        </div>

       <!-- Crossword Grid -->
       <div class="grid">
        <table class="crossword-table">
            {% for row in crossword_grid %}
                <tr>
                    {% for cell in row %}
                        {% if cell.letter == '-' %}
                            <td class="black-square"></td>
                        {% else %}
                            <td
                                class="white-square"
                                data-across-number="{% if cell.across_number %}{{ cell.across_number }}{% endif %}"
                                data-down-number="{% if cell.down_number %}{{ cell.down_number }}{% endif %}"
                            >
                                <div class="cell">
                                    {% if cell.label %}
                                        <span class="corner-number">{{ cell.label }}</span>
                                    {% endif %}
                                    <input
                                        type="text"
                                        maxlength="1"
                                        class="crossword-input"
                                        data-answer="{{ cell.letter|upper }}"
                                    />
                                </div>
                            </td>
                        {% endif %}
                    {% endfor %}
                </tr>
            {% endfor %}
        </table>
    </div>

        <!-- Toggle for showing correct/incorrect cells  -->
        <label class="toggle-container">
            <label class="switch">
                <input type="checkbox"
                id="errorToggle"
                {% if not from_saved %}checked{% endif %}>         
            <span class="slider">AUTO CHECK</span>
            </label>
        </label>

        {{ crossword_grid|json_script:"solution-grid-data" }}
        {{ across_clues|json_script:"across-clues-data" }}
        {{ down_clues|json_script:"down-clues-data" }}
        {{ category|json_script:"category-data" }}
        {{ progress_grid|default:"[]"|json_script:"progress-grid-data" }}

        {% if user.is_authenticated %}
            <button 
                id="save-crossword-btn"
                class="save-btn"
                type="button"
                data-save-url="{% url 'crossword:save_crossword' %}"
            >
                SAVE PROGRESS
            </button>
        {% else %}
            <button
                class="save-btn"
                onclick="window.location.href='{% url 'login' %}'"
            >
                LOGIN TO SAVE
            </button>
        {% endif %}
    {% endif %}  
</div>