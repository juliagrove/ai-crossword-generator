{% load static %}
<div class="crossword-container">
    {% if error_message %}
        <div class="alert">
            Failed to Generate Crossword
            <div class= "dev-error-message">
                Dev: {{ error_message }}
            </div>
        </div>
    {% else %}
        <div class="left-side">
            <div class="left-buttons">
                <!-- Auto check button -->
                <button
                    id="auto-check-btn"
                    class="auto-check-btn {% if not from_saved %}is-on{% endif %}"
                    type="button"
                >
                    AUTO CHECK
                </button>

                {{ crossword_grid|json_script:"solution-grid-data" }}
                {{ across_clues|json_script:"across-clues-data" }}
                {{ down_clues|json_script:"down-clues-data" }}
                {{ category|json_script:"category-data" }}
                {{ progress_grid|default:"[]"|json_script:"progress-grid-data" }}

                <!-- Save Crossword Button -->
                {% if user.is_authenticated %}
                    <button 
                        id="save-crossword-btn"
                        class="save-btn"
                        type="button"
                        data-save-url="{% url 'crossword:save_crossword' %}"
                    >
                        SAVE PROGRESS
                    </button>
                {% else %}
                    <button
                        class="save-btn"
                        onclick="window.location.href='{% url 'login' %}'"
                    >
                        LOGIN TO SAVE
                    </button>
                {% endif %}

                <!-- Reveal solution button -->
                <button 
                    id="reveal-solution-btn" 
                    class="save-btn" 
                    type="button"
                >
                    REVEAL SOLUTION
                </button>
            </div>
            <!-- List of Clues -->
            <div class="wordList">
                <div class="across-clues">
                    <h3>ACROSS</h3>
                    <ul>
                        {% for clue in across_clues %}
                            <li
                                class="clue-item"
                                data-direction="across"
                                data-clue-number="{{ clue.number }}"
                            >
                                <strong>{{ clue.number }}.</strong> {{ clue.clue }}
                            </li>
                        {% endfor %}
                    </ul>
                </div>
                <div class="down-clues">
                    <h3>DOWN</h3>
                    <ul>
                        {% for clue in down_clues %}
                            <li
                                class="clue-item"
                                data-direction="down"
                                data-clue-number="{{ clue.number }}"
                            >
                                <strong>{{ clue.number }}.</strong> {{ clue.clue }}</li>
                        {% endfor %}
                    </ul>
                </div>
            </div>
        </div>

       <!-- Crossword Grid -->
       <div class="grid">
        <table class="crossword-table">
            {% for row in crossword_grid %}
                <tr>
                    {% for cell in row %}
                        {% if cell.letter == '-' %}
                            <td class="black-square"></td>
                        {% else %}
                            <td
                                class="white-square"
                                data-across-number="{% if cell.across_number %}{{ cell.across_number }}{% endif %}"
                                data-down-number="{% if cell.down_number %}{{ cell.down_number }}{% endif %}"
                            >
                                <div class="cell">
                                    {% if cell.label %}
                                        <span class="corner-number">{{ cell.label }}</span>
                                    {% endif %}
                                    <input
                                        type="text"
                                        maxlength="1"
                                        class="crossword-input"
                                        data-answer="{{ cell.letter|upper }}"
                                        data-across-number="{% if cell.across_number %}{{ cell.across_number }}{% endif %}"
                                        data-down-number="{% if cell.down_number %}{{ cell.down_number }}{% endif %}"
                                    />
                                </div>
                            </td>
                        {% endif %}
                    {% endfor %}
                </tr>
            {% endfor %}
        </table>
    </div>
    {% endif %}  
</div>